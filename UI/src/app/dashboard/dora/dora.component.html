<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  Copyright 2014 CapitalOne, LLC.
  Further development Copyright 2022 Sapient Corporation.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<div id="dora-content-wrapper" *ngIf="!noProjects else noProjectsTemplate">
  <div *ngIf="!noKpis else noKpiTemplate">
    <div id="message"></div>
    <div *ngIf="selectedtype.toLowerCase() === 'scrum'">
      <div class="clearfix">
        <div class="right-container col">
          <div class="p-grid p-justify-center p-ai-center p-pt-3 p-px-2 p-m-0">
            <div class="kpi-summary p-mr-2 position-relative" *ngIf="kpiConfigData['kpi116']">
              <h4 class="p-m-0 p-text-center">Change Failure Rate</h4>
              <div *ngIf="(kpiChartData['kpi116']?.length > 0 && chartColorList['kpi116']?.length>0); else noData1">
                <div class="p-mt-3 summary-circle p-text-center"
                  [ngStyle]="{'background-color': kpiChartData['kpi116']?.[0]?.maturityColor}"
                  (mouseover)="showTooltip($event, true, 'kpi116')"
                  (mouseleave)="showTooltip($event, false, 'kpi116')">
                  {{kpiChartData['kpi116']?.[0]?.aggregationValue + " " +
                  updatedConfigDataObj['kpi116']?.kpiDetail?.kpiUnit}}

                  <app-tooltip *ngIf="isTooltip === 'kpi116'" [data]="maturityObj['kpi116']" [toolTipTop]="toolTipTop"
                    [showingMaturityRange]="true" (mouseleave)="showTooltip(null, false, 'kpi116')"
                    [kpiName]="kpiData?.kpiName"></app-tooltip>
                </div>
              </div>
              <ng-template #noData1>
                <div class="overlay"
                  *ngIf="(kpiChartData['kpi116'] && kpiChartData['kpi116']?.length) || kpiLoader">
                  <div class="loading-img"></div>
                </div>
                <div class="min-ht"
                  *ngIf="(kpiChartData['kpi116'] && kpiChartData['kpi116']?.length === 0 && kpiLoader === false)">
                  <div class="err">No Data Available</div>
                </div>
              </ng-template>
            </div>


            <div class="kpi-summary p-mr-2 position-relative" *ngIf="kpiConfigData['kpi118']">
              <h4 class="p-m-0 p-text-center">Deployment Frequency </h4>
              <div *ngIf="(kpiChartData['kpi118']?.length > 0 && chartColorList['kpi118']?.length>0); else noData2">
                <div class="p-mt-3 summary-circle p-text-center" (mouseover)="showTooltip($event, true, 'kpi118')"
                  (mouseleave)="showTooltip($event, false, 'kpi118')"
                  [ngStyle]="{'background-color': kpiChartData['kpi118']?.[0]?.maturityColor}">
                  {{kpiChartData['kpi118']?.[0]?.aggregationValue}}

                  <app-tooltip *ngIf="isTooltip === 'kpi118'" [data]="maturityObj['kpi118']"
                    [showingMaturityRange]="true" (mouseleave)="showTooltip(null, false, 'kpi118')"
                    [kpiName]="kpiData?.kpiName" [toolTipTop]="toolTipTop"></app-tooltip>
                </div>
              </div>
              <ng-template #noData2>
                <div class="overlay"
                  *ngIf="(kpiChartData['kpi118'] && kpiChartData['kpi118']?.length > 0) || kpiLoader">
                  <div class="loading-img"></div>
                </div>
                <div class="min-ht"
                  *ngIf="(kpiChartData['kpi118'] && kpiChartData['kpi118']?.length === 0 && kpiLoader === false)">
                  <div class="err">No Data Available</div>
                </div>
              </ng-template>
            </div>

            <div class="kpi-summary p-mr-2 position-relative" *ngIf="kpiConfigData['kpi156']">
              <h4 class="p-m-0 p-text-center">Lead Time For Change</h4>
              <div *ngIf="(kpiChartData['kpi156']?.length > 0 && chartColorList['kpi156']?.length>0); else noData5">
                <div class="p-mt-3 summary-circle p-text-center" (mouseover)="showTooltip($event, true, 'kpi156')"
                  (mouseleave)="showTooltip($event, false, 'kpi156')"
                  [ngStyle]="{'background-color': kpiChartData['kpi156']?.[0]?.maturityColor}">
                  {{kpiChartData['kpi156']?.[0]?.aggregationValue + " " +
                  updatedConfigDataObj['kpi156']?.kpiDetail?.kpiUnit}}

                  <app-tooltip *ngIf="isTooltip === 'kpi156'" [data]="maturityObj['kpi156']"
                    [showingMaturityRange]="true" (mouseleave)="showTooltip(null, false, 'kpi156')"
                    [kpiName]="kpiData?.kpiName" [toolTipTop]="toolTipTop"></app-tooltip>
                </div>
              </div>
              <ng-template #noData5>
                <div class="overlay"
                  *ngIf="(kpiChartData['kpi156'] && kpiChartData['kpi156']?.length > 0) || kpiLoader">
                  <div class="loading-img"></div>
                </div>
                <div class="min-ht"
                  *ngIf="(kpiChartData['kpi156'] && kpiChartData['kpi156']?.length === 0 && kpiLoader === false)">
                  <div class="err">No Data Available</div>
                </div>
              </ng-template>
            </div>


            <div class="kpi-summary p-mr-2 position-relative" *ngIf="kpiConfigData['kpi166']">
              <h4 class="p-m-0 p-text-center">Mean Time to Recover </h4>
              <div *ngIf="(kpiChartData['kpi166']?.length > 0 && chartColorList['kpi166']?.length>0); else noData6">
                <div class="p-mt-3 summary-circle p-text-center" (mouseover)="showTooltip($event, true, 'kpi166')"
                  (mouseleave)="showTooltip($event, false, 'kpi166')"
                  [ngStyle]="{'background-color': kpiChartData['kpi166']?.[0]?.maturityColor}">
                  {{kpiChartData['kpi166']?.[0]?.aggregationValue + " " +
                  updatedConfigDataObj['kpi166']?.kpiDetail?.kpiUnit}}

                  <app-tooltip *ngIf="isTooltip === 'kpi166'" [data]="maturityObj['kpi166']"
                    [showingMaturityRange]="true" [kpiName]="kpiData?.kpiName"
                    [toolTipTop]="toolTipTop"></app-tooltip>
                </div>

              </div>
              <ng-template #noData6>
                <div class="overlay"
                  *ngIf="(kpiChartData['kpi166'] && kpiChartData['kpi166']?.length > 0) || kpiLoader">
                  <div class="loading-img"></div>
                </div>
                <div class="min-ht"
                  *ngIf="(kpiChartData['kpi166'] && kpiChartData['kpi166']?.length === 0 && kpiLoader === false)">
                  <div class="err">No Data Available</div>
                </div>
              </ng-template>
            </div>

          </div>
          <div class="p-grid p-justify-center p-pt-3 p-px-2 p-m-0">
            <ng-container *ngIf="(updatedConfigGlobalData | json) != '{}' && updatedConfigGlobalData != undefined">
              <div class="p-sm-6" *ngIf="kpiConfigData['kpi116']">
                <app-kpi-card [trendBoxColorObj]="trendBoxColorObj" [kpiData]="updatedConfigDataObj['kpi116']"
                  [trendData]="kpiTrendsObj['kpi116']" [dropdownArr]="kpiDropdowns['kpi116']"
                  (downloadExcel)="downloadExcel(updatedConfigDataObj['kpi116']?.kpiId, updatedConfigDataObj['kpi116']?.kpiName, updatedConfigDataObj['kpi116']?.kpiDetail.kanban,updatedConfigDataObj['kpi116']?.kpiDetail?.isAdditionalFilterSupport)"
                  (optionSelected)="handleSelectedOption($event, updatedConfigDataObj['kpi116'])" [showExport]="true"
                  [showChartView]="showChart"
                  [sprintsOverlayVisible]="sprintsOverlayVisible && updatedConfigDataObj['kpi116']?.kpiDetail?.chartType !== 'table'"
                  [isShow]="(kpiLoader === false) && (ifKpiExist('kpi116') != -1) ? true : false"
                  [trendValueList]="kpiChartData['kpi116']" [colors]="colorObj" [showCommentIcon]="showCommentIcon"
                  [commentCount]="kpiCommentsCountObj['kpi116']" (getCommentCountByKpi)="getKpiCommentsCount($event)"
                  (reloadKPITab)="reloadKPI($event)" [board]="'dora'">
                  <ng-container *ngIf="!noTabAccess else noDataAccess">
                    <ng-container *ngIf="(kpiChartData | json) !== '{}' && kpiChartData != undefined;else noData">
                      <div class="p-pl-3 p-pr-3" *ngIf="ifKpiExist('kpi116') != -1; else loader">
                        <ng-container
                          *ngIf="(kpiChartData['kpi116']?.length > 0 && chartColorList['kpi116']?.length>0); else noData">
                          <ng-container *ngIf="showChart">
                            <app-multiline [thresholdValue]="kpiThresholdObj['kpi116']"
                              [unit]="updatedConfigDataObj['kpi116']?.kpiDetail?.kpiUnit"
                              [data]="kpiChartData['kpi116']"
                              [xCaption]="updatedConfigDataObj['kpi116']?.kpiDetail?.xaxisLabel"
                              [yCaption]="updatedConfigDataObj['kpi116']?.kpiDetail?.yaxisLabel"
                              [name]="updatedConfigDataObj['kpi116']?.kpiName" [kpiId]="'kpi116'"
                              [color]="chartColorList['kpi116']" [selectedtype]="selectedtype" [board]="'dora'">
                            </app-multiline>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-template #noData>
                      <div class="overlay"
                        *ngIf="(kpiChartData['kpi116'] && kpiChartData['kpi116']?.length) || kpiLoader">
                        <div class="loading-img"></div>
                      </div>
                      <div class="min-ht"
                        *ngIf="(kpiChartData['kpi116'] && kpiChartData['kpi116']?.length === 0 && kpiLoader === false)">
                        <div class="err">No Data Available</div>
                      </div>
                    </ng-template>
                    <ng-template #loader>
                      <div class="overlay">
                        <div class="loading-img"></div>
                      </div>
                    </ng-template>
                  </ng-container>
                </app-kpi-card>
              </div>
              <div class="p-sm-6" *ngIf="kpiConfigData['kpi118']">
                <app-kpi-card [trendBoxColorObj]="trendBoxColorObj" [kpiData]="updatedConfigDataObj['kpi118']"
                  [trendData]="kpiTrendsObj['kpi118']" [dropdownArr]="kpiDropdowns['kpi118']"
                  (optionSelected)="handleSelectedOption($event, updatedConfigDataObj['kpi118'])"
                  (downloadExcel)="downloadExcel(updatedConfigDataObj['kpi118']?.kpiId, updatedConfigDataObj['kpi118']?.kpiName, updatedConfigDataObj['kpi118']?.kpiDetail.kanban,updatedConfigDataObj['kpi118']?.kpiDetail?.isAdditionalFilterSupport)"
                  [showExport]="true" [showChartView]="showChart"
                  [isShow]="(kpiLoader === false) && (ifKpiExist('kpi118') != -1) ? true : false"
                  [sprintsOverlayVisible]="sprintsOverlayVisible && updatedConfigDataObj['kpi118']?.kpiDetail?.chartType !== 'table'"
                  [trendValueList]="kpiChartData['kpi118']" [colors]="colorObj" [showCommentIcon]="showCommentIcon"
                  [commentCount]="kpiCommentsCountObj['kpi118']" (getCommentCountByKpi)="getKpiCommentsCount($event)"
                  (reloadKPITab)="reloadKPI($event)" [board]="'dora'">
                  <ng-container *ngIf="!noTabAccess else noDataAccess">
                    <ng-container *ngIf="(kpiChartData | json) !== '{}' && kpiChartData != undefined;else noData3">
                      <div class="p-pl-3 p-pr-3" *ngIf="ifKpiExist('kpi118') != -1; else loader">
                        <ng-container
                          *ngIf="(kpiChartData['kpi118']?.length > 0 && chartColorList['kpi118']?.length>0); else noData3">
                          <ng-container *ngIf="showChart">
                            <app-multiline [thresholdValue]="kpiThresholdObj['kpi118']"
                              [unit]="updatedConfigDataObj['kpi118']?.kpiDetail?.kpiUnit"
                              [data]="kpiChartData['kpi118']"
                              [xCaption]="updatedConfigDataObj['kpi118']?.kpiDetail?.xaxisLabel"
                              [yCaption]="updatedConfigDataObj['kpi118']?.kpiDetail?.yaxisLabel"
                              [name]="updatedConfigDataObj['kpi118']?.kpiName" [kpiId]="'kpi118'"
                              [color]="chartColorList['kpi118']" [selectedtype]="selectedtype" [board]="'dora'">
                            </app-multiline>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-template #noData3>
                      <div class="overlay"
                        *ngIf="(kpiChartData['kpi118'] && kpiChartData['kpi118']?.length > 0) || kpiLoader">
                        <div class="loading-img"></div>
                      </div>
                      <div class="min-ht"
                        *ngIf="(kpiChartData['kpi118'] && kpiChartData['kpi118']?.length === 0 && kpiLoader === false)">
                        <div class="err">No Data Available</div>
                      </div>
                    </ng-template>
                    <ng-template #loader>
                      <div class="overlay">
                        <div class="loading-img"></div>
                      </div>
                    </ng-template>
                  </ng-container>
                </app-kpi-card>
              </div>
              <ng-template #noDataAccess>
                <div class="min-ht">
                  <div class="err"> No Data Available</div>
                </div>
              </ng-template>
            </ng-container>

              <div class="p-sm-6" *ngIf="kpiConfigData['kpi156']">
                <app-kpi-card [trendBoxColorObj]="trendBoxColorObj" [kpiData]="updatedConfigDataObj['kpi156']"
                  [trendData]="kpiTrendsObj['kpi156']" [dropdownArr]="kpiDropdowns['kpi156']"
                  (downloadExcel)="downloadExcel(updatedConfigDataObj['kpi156']?.kpiId, updatedConfigDataObj['kpi156']?.kpiName, updatedConfigDataObj['kpi156']?.kpiDetail.kanban,updatedConfigDataObj['kpi156']?.kpiDetail?.isAdditionalFilterSupport)"
                  (optionSelected)="handleSelectedOption($event, updatedConfigDataObj['kpi156'])" [showExport]="true"
                  [showChartView]="showChart"
                  [sprintsOverlayVisible]="sprintsOverlayVisible && updatedConfigDataObj['kpi156']?.kpiDetail?.chartType !== 'table'"
                  [isShow]="(kpiLoader === false) && (ifKpiExist('kpi156') != -1) ? true : false"
                  [trendValueList]="kpiChartData['kpi156']" [colors]="this.colorObj" [showCommentIcon]="showCommentIcon"
                  [commentCount]="kpiCommentsCountObj['kpi156']" (getCommentCountByKpi)="getKpiCommentsCount($event)"
                  (reloadKPITab)="reloadKPI($event)" [board]="'dora'">
                  <ng-container *ngIf="!noTabAccess else noDataAccess">
                    <ng-container *ngIf="(kpiChartData | json) !== '{}' && kpiChartData != undefined;else noData4">
                      <div class="p-pl-3 p-pr-3" *ngIf="ifKpiExist('kpi156') != -1; else loader">
                        <ng-container
                          *ngIf="(kpiChartData['kpi156']?.length > 0 && chartColorList['kpi156']?.length>0); else noData4">
                          <ng-container *ngIf="showChart">
                            <app-multiline [thresholdValue]="kpiThresholdObj['kpi156']"
                              [unit]="updatedConfigDataObj['kpi156']?.kpiDetail?.kpiUnit"
                              [data]="kpiChartData['kpi156']"
                              [xCaption]="updatedConfigDataObj['kpi156']?.kpiDetail?.xaxisLabel"
                              [yCaption]="updatedConfigDataObj['kpi156']?.kpiDetail?.yaxisLabel"
                              [name]="updatedConfigDataObj['kpi156']?.kpiName" [kpiId]="'kpi156'"
                              [color]="chartColorList['kpi156']" [selectedtype]="selectedtype" [board]="'dora'">
                            </app-multiline>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-template #noData4>
                      <div class="overlay"
                        *ngIf="(kpiChartData['kpi156'] && kpiChartData['kpi156']?.length) || kpiLoader">
                        <div class="loading-img"></div>
                      </div>
                      <div class="min-ht"
                        *ngIf="(kpiChartData['kpi156'] && kpiChartData['kpi156']?.length === 0 && kpiLoader === false)">
                        <div class="err">No Data Available</div>
                      </div>
                    </ng-template>
                    <ng-template #loader>
                      <div class="overlay">
                        <div class="loading-img"></div>
                      </div>
                    </ng-template>
                  </ng-container>
                </app-kpi-card>
              </div>

              <div class="p-sm-6" *ngIf="kpiConfigData['kpi166']">
                <app-kpi-card [trendBoxColorObj]="trendBoxColorObj" [kpiData]="updatedConfigDataObj['kpi166']"
                  [trendData]="kpiTrendsObj['kpi166']" [dropdownArr]="kpiDropdowns['kpi166']"
                  (optionSelected)="handleSelectedOption($event, updatedConfigDataObj['kpi166'])"
                  (downloadExcel)="downloadExcel(updatedConfigDataObj['kpi166']?.kpiId, updatedConfigDataObj['kpi166']?.kpiName, updatedConfigDataObj['kpi166']?.kpiDetail.kanban,updatedConfigDataObj['kpi166']?.kpiDetail?.isAdditionalFilterSupport)"
                  [showExport]="true" [showChartView]="showChart"
                  [isShow]="(kpiLoader === false) && (ifKpiExist('kpi166') != -1) ? true : false"
                  [sprintsOverlayVisible]="sprintsOverlayVisible && updatedConfigDataObj['kpi166']?.kpiDetail?.chartType !== 'table'"
                  [trendValueList]="kpiChartData['kpi166']" [colors]="colorObj" [showCommentIcon]="showCommentIcon"
                  [commentCount]="kpiCommentsCountObj['kpi166']" (getCommentCountByKpi)="getKpiCommentsCount($event)"
                  (reloadKPITab)="reloadKPI($event)" [board]="'dora'">
                  <ng-container *ngIf="!noTabAccess else noDataAccess">
                    <ng-container *ngIf="(kpiChartData | json) !== '{}' && kpiChartData != undefined;else noData7">
                      <div class="p-pl-3 p-pr-3" *ngIf="ifKpiExist('kpi166') != -1; else loader">
                        <ng-container
                          *ngIf="(kpiChartData['kpi166']?.length > 0 && chartColorList['kpi166']?.length>0); else noData7">
                          <ng-container *ngIf="showChart">
                            <app-multiline [thresholdValue]="updatedConfigDataObj['kpi166']?.kpiDetail?.thresholdValue"
                              [unit]="updatedConfigDataObj['kpi166']?.kpiDetail?.kpiUnit"
                              [data]="kpiChartData['kpi166']"
                              [xCaption]="updatedConfigDataObj['kpi166']?.kpiDetail?.xaxisLabel"
                              [yCaption]="updatedConfigDataObj['kpi166']?.kpiDetail?.yaxisLabel"
                              [name]="updatedConfigDataObj['kpi166']?.kpiName" [kpiId]="'kpi166'"
                              [color]="chartColorList['kpi166']" [selectedtype]="selectedtype" [board]="'dora'">
                            </app-multiline>
                          </ng-container>
                        </ng-container>
                      </div>
                    </ng-container>
                    <ng-template #noData7>
                      <div class="overlay"
                        *ngIf="(kpiChartData['kpi166'] && kpiChartData['kpi166']?.length > 0) || kpiLoader">
                        <div class="loading-img"></div>
                      </div>
                      <div class="min-ht"
                        *ngIf="(kpiChartData['kpi166'] && kpiChartData['kpi166']?.length === 0 && kpiLoader === false)">
                        <div class="err">No Data Available</div>
                      </div>
                    </ng-template>
                    <ng-template #loader>
                      <div class="overlay">
                        <div class="loading-img"></div>
                      </div>
                    </ng-template>
                  </ng-container>
                </app-kpi-card>
              </div>
              <ng-template #noDataAccess>
                <div class="min-ht">
                  <div class="err"> No Data Available</div>
                </div>
              </ng-template>
          </div>
        </div>
      </div>
    </div>
    <!--Region: Adding kanban for dora-->
    <div *ngIf="selectedtype.toLowerCase() === 'kanban'">
      <div class="p-grid justify-content-start p-pl-2 p-pr-2 p-m-0">
        <ng-container
            *ngIf="(updatedConfigGlobalData | json) != '{}' && updatedConfigGlobalData != undefined">
            <ng-container *ngFor="let kpi of updatedConfigGlobalData; let i = index;">
                <div *ngIf="selectedKPITab === kpi.kpiDetail.kpiSubCategory && kpi['isEnabled']"
                    class="{{ kpi.kpiDetail?.kpiWidth ? kpi.kpiDetail?.kpiWidth === 100 ? 'p-col-12' : 'p-col-6'  : 'p-col-6'  }}">
                    <app-kpi-card-v2 [selectedTab]="selectedTab"
                        [nodeId]="filterApplyData?.selectedMap?.['release']?.[0]"
                        [trendBoxColorObj]="trendBoxColorObj" [kpiData]="kpi"
                        [loader]="loadedKpi.has(kpi?.kpiId)" [trendData]="kpiTrendsObj[kpi?.kpiId]"
                        [cols]="kpiChartData[kpi?.kpiId]?.columnHeaders"
                        [showTrendIndicator]="showKpiTrendIndicator[kpi?.kpiId] ==false ? showKpiTrendIndicator[kpi?.kpiId] : true"
                        (downloadExcel)="downloadExcel(kpi.kpiId, kpi.kpiName, kpi.kpiDetail.kanban, kpi?.kpiDetail?.isAdditionalFilterSupport)"
                        [dropdownArr]="kpiDropdowns[kpi?.kpiId]"
                        (optionSelected)="handleSelectedOption($event, kpi)"
                        [showExport]="(showChart === 'chart' || showChart === 'large')"
                        [showChartView]="showChart"
                        [iSAdditionalFilterSelected]="iSAdditionalFilterSelected"
                        [sprintsOverlayVisible]="sprintsOverlayVisible && kpi?.kpiDetail?.chartType !== 'table'"
                        [trendValueList]="kpiChartData[kpi?.kpiId]" [colors]="colorObj"
                        [showCommentIcon]="showCommentIcon"
                        [commentCount]="kpiCommentsCountObj[kpi?.kpiId]"
                        (getCommentCountByKpi)="getKpiCommentsCount($event)"
                        (reloadKPITab)="reloadKPI($event)" [kpiSize]="kpi.kpiDetail.kpiSize" [kpiChartData]="kpiChartData"
                        [immediateLoader]='immediateLoader'>
                        <ng-container *ngIf="!noTabAccess else noDataAccess">
                            <ng-container *ngIf="kpiChartData[kpi?.kpiId]?.length">
                                <div [ngSwitch]="kpi?.kpiDetail?.chartType">
                                    <ng-container
                                        *ngIf="!loadedKpi.has(kpi?.kpiId) && kpiChartData[kpi?.kpiId]">
                                        <ng-container *ngIf="!(showChart === 'table')">
                                            <ng-container *ngSwitchCase="'stackedColumn'">
                                                <ng-container
                                                    *ngIf="checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <app-groupstackchart [legendType]="'normal'"
                                                        [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] : kpi?.kpiDetail?.xaxisLabel"
                                                        [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                        [unit]="kpi?.kpiDetail?.kpiUnit"
                                                        [filter]="kpiSelectedFilterObj[kpi?.kpiId]"
                                                        [thresholdValue]="kpiThresholdObj[kpi?.kpiId]"
                                                        [data]="kpiChartData[kpi?.kpiId]"
                                                        [color]="chartColorList"
                                                        [kpiId]="kpi?.kpiId"
                                                        [selectedtype]="selectedtype"
                                                        [activeTab]="activeIndex"
                                                        [isAggregationStacks]="(kpi?.kpiDetail?.isAggregationStacks === false) ? false : true"></app-groupstackchart>
                                                </ng-container>
                                                <ng-container
                                                    *ngIf="!checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <ng-container
                                                        *ngTemplateOutlet="zeroData; context:  { $implicit: kpiSelectedFilterObj[kpi?.kpiId] }">
                                                    </ng-container>
                                                </ng-container>
                                            </ng-container>
  
                                            <app-table *ngSwitchCase="'table'"
                                                [trendBoxColorObj]="trendBoxColorObj"
                                                [data]="kpiChartData[kpi?.kpiId].data"
                                                [cols]="kpiChartData[kpi?.kpiId]?.columnHeaders"
                                                [showMarker]="'true'"
                                                [showMarkerColumnNumber]="0"></app-table>
                                            <app-multiline-v2 *ngSwitchCase="'line'"
                                                [thresholdValue]="kpiThresholdObj[kpi?.kpiId]"
                                                [unit]="kpi?.kpiDetail?.kpiUnit"
                                                [data]="kpiChartData[kpi?.kpiId]"
                                                [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] : kpi?.kpiDetail?.xaxisLabel"
                                                [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                [name]="kpi?.kpiName" [kpiId]="kpi?.kpiId"
                                                [color]="chartColorList[kpi?.kpiId]"
                                                [selectedtype]="selectedtype" [viewType]="showChart"
                                                [board]="selectedTab"
                                                [lowerThresholdBG]="kpi?.kpiDetail?.lowerThresholdBG"
                                                [upperThresholdBG]="kpi?.kpiDetail?.upperThresholdBG">
                                            </app-multiline-v2>
                                            <app-multiline-style-v2 *ngSwitchCase="'multipleline'"
                                                [thresholdValue]="kpiThresholdObj[kpi?.kpiId]"
                                                [unit]="kpi?.kpiDetail?.kpiUnit"
                                                [data]="kpiChartData[kpi?.kpiId]"
                                                [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] : kpi?.kpiDetail?.xaxisLabel"
                                                [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                [name]="kpi?.kpiName" [kpiId]="kpi?.kpiId"
                                                [color]="chartColorList[kpi?.kpiId]"
                                                [selectedtype]="selectedtype"
                                                [viewType]="showChart">
                                            </app-multiline-style-v2>
                                            <app-grouped-column-plus-line-chart-v2
                                                *ngSwitchCase="'grouped_column_plus_line'"
                                                [data]="kpiChartData[kpi?.kpiId]" [lineChart]="true"
                                                [unit]="kpi?.kpiDetail?.kpiUnit"
                                                [thresholdValue]="kpiThresholdObj[kpi?.kpiId]"
                                                [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] : kpi?.kpiDetail?.xaxisLabel"
                                                [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                [color]="chartColorList[kpi?.kpiId]"
                                                [barLegend]="kpi?.kpiDetail?.barLegend"
                                                [lineLegend]="kpi?.kpiDetail?.lineLegend"
                                                [selectedtype]="selectedtype" [viewType]="showChart"
                                                [lowerThresholdBG]="kpi?.kpiDetail?.lowerThresholdBG"
                                                [upperThresholdBG]="kpi?.kpiDetail?.upperThresholdBG"
                                                [board]="selectedTab">
                                            </app-grouped-column-plus-line-chart-v2>
                                            <app-bar-with-y-axis-group
                                                *ngSwitchCase="'bar-with-y-axis-group'"
                                                [data]="kpiChartData[kpi?.kpiId]" [lineChart]="true"
                                                [unit]="kpi?.kpiDetail?.kpiUnit"
                                                [thresholdValue]="kpi?.kpiDetail?.thresholdValue"
                                                [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] : kpi?.kpiDetail?.xaxisLabel"
                                                [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                [color]="chartColorList[kpi?.kpiId]"
                                                [barLegend]="kpi?.kpiDetail?.barLegend"
                                                [lineLegend]="kpi?.kpiDetail?.lineLegend"
                                                [selectedtype]="selectedtype" [viewType]="showChart"
                                                [lowerThresholdBG]="kpi?.kpiDetail?.lowerThresholdBG"
                                                [upperThresholdBG]="kpi?.kpiDetail?.upperThresholdBG"
                                                [yAxisOrder]="kpi?.kpiDetail?.yaxisOrder">
                                            </app-bar-with-y-axis-group>
  
                                            <ng-container
                                                *ngSwitchCase="'CumulativeMultilineChart'">
                                                <app-group-bar-chart
                                                    [xCaption]="this.filterApplyData.selectedMap['date'] && this.filterApplyData.selectedMap['date'][0] ? this.filterApplyData.selectedMap['date'][0] :kpi?.kpiDetail?.xaxisLabel"
                                                    [yCaption]="kpi?.kpiDetail?.yaxisLabel"
                                                    [unit]="kpi?.kpiDetail?.kpiUnit"
                                                    [thresholdValue]="kpiThresholdObj[kpi?.kpiId]"
                                                    [data]="kpiChartData[kpi?.kpiId]"
                                                    [color]="chartColorList"
                                                    [releaseEndDate]="releaseEndDate"
                                                    [selectedtype]="selectedtype"
                                                    [kpiId]="kpi?.kpiId" [legendType]="'normal'">
                                                </app-group-bar-chart>
                                            </ng-container>
  
                                            <ng-container
                                                *ngSwitchCase="'horizontalPercentBarChart'">
                                                <ng-container
                                                    *ngIf="checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <app-horizontal-percent-bar-chartv2
                                                        [kpiId]="kpi?.kpiId"
                                                        [kpiWidth]="kpi?.kpiDetail?.kpiWidth"
                                                        [data]="kpiChartData[kpi?.kpiId]"
                                                        [activeTab]="activeIndex">
                                                    </app-horizontal-percent-bar-chartv2>
                                                </ng-container>
                                                <ng-container
                                                    *ngIf="!checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <ng-container
                                                        *ngTemplateOutlet="zeroData; context:  { $implicit: kpiSelectedFilterObj[kpi?.kpiId] }"></ng-container>
                                                </ng-container>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'pieChart'">
                                                <ng-container
                                                    *ngIf="checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <app-piechart
                                                        [data]="kpiChartData[kpi?.kpiId]"></app-piechart>
                                                </ng-container>
                                                <ng-container
                                                    *ngIf="!checkIfDataPresent(kpiChartData[kpi?.kpiId]);">
                                                    <ng-container
                                                        *ngTemplateOutlet="zeroData; context:  { $implicit: kpiSelectedFilterObj[kpi?.kpiId] }"></ng-container>
                                                </ng-container>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="'chartWithFilter'">
                                                <ng-container
                                                    *ngIf="kpiChartData[kpi?.kpiId]?.[0]?.data?.length; else noDataForChartWithFilters">
                                                    <app-chart-with-filters
                                                        [data]="kpiChartData[kpi?.kpiId]?.[0]?.data"
                                                        [kpiId]="kpi?.kpiId"
                                                        [kpiName]="kpi?.kpiName"
                                                        [filters]="kpiChartData[kpi?.kpiId]?.[0]?.filters"
                                                        [modalHeads]="kpiChartData[kpi?.kpiId]?.[0]?.modalHeads">
                                                    </app-chart-with-filters>
                                                </ng-container>
                                            </ng-container>
                                        </ng-container>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </ng-container>
                    </app-kpi-card-v2>
  
                </div>
                <ng-template #zeroData let-data>
                    <div class="min-ht" *ngIf="!loader">
                        <div class="p-w-100  p-d-flex p-justify-center">
                            <img alt="no-data" src="../../../assets/img/NoDataFound.svg" />
                        </div>
                        <div class="p-w-100">
                            <h4 class="p-text-center">No data
                                {{ data?.filter1 ? 'for ' + data?.filter1[0] : ''}}.</h4>
                        </div>
                    </div>
  
                </ng-template>
                <ng-template #noDataAccess>
                    <div class="min-ht">
                        <div class="err"> No Data Available</div>
                    </div>
                </ng-template>
            </ng-container>
        </ng-container>
      </div>
    </div>

    <!--End Region-->
  </div>
  <ng-template #noKpiTemplate>
    <div class="no-kpi-template">
      <app-no-access [selectedTab]="''" [userEnable]='enableByUser'></app-no-access>
    </div>
  </ng-template>
</div>
<ng-template #noProjectsTemplate>
  <div class="p-d-flex p-align-center p-justify-center no-projects">
    <h2>You do not have access to any Scrum project</h2>
  </div>
</ng-template>

<app-export-excel #exportExcel></app-export-excel>
